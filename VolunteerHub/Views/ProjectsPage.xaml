<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="VolunteerHub.Views.ProjectsPage"
             Title="Projects"
             BackgroundColor="#ECF0F1">

    <Grid RowDefinitions="Auto,Auto,*" Padding="20" RowSpacing="15">

        <!-- Header -->
        <VerticalStackLayout Grid.Row="0" Spacing="5">
            <Label Text="Project Management"
                   FontSize="24"
                   FontAttributes="Bold"
                   TextColor="#2C3E50" />
            <Label Text="View and manage NGO projects"
                   FontSize="14"
                   TextColor="#7F8C8D" />
        </VerticalStackLayout>

        <!-- Search and Add Section -->
        <Grid Grid.Row="1" ColumnDefinitions="*,Auto" ColumnSpacing="10">

            <!-- Search Bar -->
            <Frame Grid.Column="0"
                   BackgroundColor="White"
                   CornerRadius="8"
                   HasShadow="False"
                   BorderColor="#BDC3C7"
                   Padding="0">
                <SearchBar x:Name="SearchBar"
                           Placeholder="Search projects..."
                           TextColor="#2C3E50"
                           PlaceholderColor="#95A5A6"
                           BackgroundColor="Transparent"
                           SearchButtonPressed="OnSearchPressed"
                           TextChanged="OnSearchTextChanged" />
            </Frame>

            <!-- Add Button -->
            <Button Grid.Column="1"
                    Text="+ Add Project"
                    BackgroundColor="#3498DB"
                    TextColor="White"
                    FontSize="14"
                    FontAttributes="Bold"
                    CornerRadius="8"
                    Clicked="OnAddProjectClicked"
                    WidthRequest="150" />
        </Grid>

        <!-- Projects List -->
        <CollectionView Grid.Row="2"
                        x:Name="ProjectsCollectionView"
                        SelectionMode="None">

            <CollectionView.EmptyView>
                <ContentView>
                    <VerticalStackLayout HorizontalOptions="Center" 
                                        VerticalOptions="Center"
                                        Spacing="10">
                        <Label Text="No projects found"
                               FontSize="18"
                               TextColor="#95A5A6"
                               HorizontalOptions="Center" />
                        <Label Text="Click 'Add Project' to get started"
                               FontSize="14"
                               TextColor="#BDC3C7"
                               HorizontalOptions="Center" />
                    </VerticalStackLayout>
                </ContentView>
            </CollectionView.EmptyView>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Margin="0,0,0,10" 
                           Padding="20"
                           BackgroundColor="White"
                           CornerRadius="8"
                           HasShadow="False"
                           BorderColor="#BDC3C7">

                        <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto,Auto,Auto,Auto" ColumnSpacing="15">

                            <!-- Status Indicator -->
                            <BoxView Grid.Row="0" Grid.Column="0" Grid.RowSpan="4"
                                     WidthRequest="4"
                                     CornerRadius="2"
                                     Color="{Binding Status, Converter={StaticResource StatusColorConverter}}"
                                     VerticalOptions="FillAndExpand" />

                            <!-- Project Name -->
                            <Label Grid.Row="0" Grid.Column="1"
                                   Text="{Binding ProjectName}"
                                   FontSize="18"
                                   FontAttributes="Bold"
                                   TextColor="#2C3E50" />

                            <!-- Status Badge -->
                            <Frame Grid.Row="0" Grid.Column="2"
                                   Padding="8,4"
                                   CornerRadius="4"
                                   HasShadow="False"
                                   BackgroundColor="{Binding Status, Converter={StaticResource StatusColorConverter}}">
                                <Label Text="{Binding Status}"
                                       FontSize="11"
                                       TextColor="White"
                                       FontAttributes="Bold" />
                            </Frame>

                            <!-- Description -->
                            <Label Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2"
                                   Text="{Binding Description}"
                                   FontSize="14"
                                   TextColor="#7F8C8D"
                                   LineBreakMode="TailTruncation"
                                   MaxLines="2"
                                   Margin="0,5,0,0" />

                            <!-- Dates -->
                            <Label Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="2"
                                   FontSize="14"
                                   TextColor="#7F8C8D"
                                   Margin="0,5,0,0">
                                <Label.Text>
                                    <MultiBinding StringFormat="{}Start: {0:yyyy-MM-dd} | End: {1:yyyy-MM-dd}">
                                        <Binding Path="StartDate" />
                                        <Binding Path="EndDate" />
                                    </MultiBinding>
                                </Label.Text>
                            </Label>

                            <!-- Required Volunteers -->
                            <Label Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2"
                                   FontSize="14"
                                   TextColor="#7F8C8D"
                                   Margin="0,2,0,0">
                                <Label.Text>
                                    <MultiBinding StringFormat="{}Required Volunteers: {0}">
                                        <Binding Path="RequiredVolunteers" />
                                    </MultiBinding>
                                </Label.Text>
                            </Label>

                            <!-- Action Buttons -->
                            <HorizontalStackLayout Grid.Row="4" Grid.Column="1" Grid.ColumnSpan="2"
                                                  Spacing="10"
                                                  Margin="0,15,0,0">

                                <Button Text="Edit"
                                        BackgroundColor="#3498DB"
                                        TextColor="White"
                                        FontSize="12"
                                        FontAttributes="Bold"
                                        CornerRadius="4"
                                        Padding="15,8"
                                        Clicked="OnEditProjectClicked"
                                        CommandParameter="{Binding .}" />

                                <Button Text="Delete"
                                        BackgroundColor="#E74C3C"
                                        TextColor="White"
                                        FontSize="12"
                                        FontAttributes="Bold"
                                        CornerRadius="4"
                                        Padding="15,8"
                                        Clicked="OnDeleteProjectClicked"
                                        CommandParameter="{Binding .}" />

                                <Button Text="View Details"
                                        BackgroundColor="#95A5A6"
                                        TextColor="White"
                                        FontSize="12"
                                        FontAttributes="Bold"
                                        CornerRadius="4"
                                        Padding="15,8"
                                        Clicked="OnViewDetailsClicked"
                                        CommandParameter="{Binding .}" />
                            </HorizontalStackLayout>

                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </Grid>

</ContentPage>